{# security/templates/security/login.html #}
{% extends 'base.html' %} {# Extiende tu plantilla base #}

{% block title %}Simulación de Login Sospechoso{% endblock %}

{% block content %}
<div class="container">
    <h2>Simulación de Login</h2>

    {# Mostrar mensajes de resultado #}
    {% if message %}
        <div style="padding: 10px; margin-bottom: 20px; border: 1px solid; {% if is_suspicious %} border-color: red; color: red; background-color: #ffe6e6; {% else %} border-color: green; color: green; background-color: #e6ffe6; {% endif %}">
            {{ message }}
        </div>
    {% endif %}

    {# Formulario de login simulado #}
    <form method="post">
        {% csrf_token %} {# Token de seguridad CSRF #}
        <div class="form-group">
            <label for="username">Nombre de Usuario (simulado):</label>
            <input type="text" class="form-control" id="username" name="username" required value="{{ username_attempted|default:'' }}">
        </div>
        <button type="submit" class="btn btn-primary">Intentar Login</button>
    </form>

    {# Opcional: Mostrar el contador de errores detectados aquí #}
    <div style="margin-top: 20px;">
        <p>Total de intentos sospechosos detectados (registrados): <strong>{{ total_suspicious_detected|default:0 }}</strong></p>
        <p><a href="{% url 'list_suspicious' %}">Ver historial de intentos sospechosos</a></p> {# Enlace a la lista (paso opcional 10) #}
    </div>

</div>
{% endblock %}